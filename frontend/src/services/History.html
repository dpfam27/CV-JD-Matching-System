<!DOCTYPE html>
<html>
<head>
    <title>Jobscan - HISTORY</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Inter, system-ui, -apple-system, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        header {
            background: white;
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #2557a7;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .filters {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        select, input {
            padding: 0.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .scan-list {
            display: grid;
            gap: 1.5rem;
        }

        .scan-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 2rem;
            align-items: center;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }

        .high-score {
            background: #22c55e;
        }

        .medium-score {
            background: #f59e0b;
        }

        .low-score {
            background: #ef4444;
        }

        .scan-details h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .scan-meta {
            display: flex;
            gap: 2rem;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .skills-list {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .skill-tag {
            background: #e3f2fd;
            color: #1565c0;
            padding: 0.25rem 0.75rem;
            border-radius: 100px;
            font-size: 0.85rem;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            text-align: center;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.2s;
        }

        .btn-primary {
            background: #2557a7;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4589;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .page-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }

        .page-btn.active {
            background: #2557a7;
            color: white;
            border-color: #2557a7;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .empty-state p {
            color: #666;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">PRO MATCHER</div>
        </nav>
    </header>

    <div class="container">
        <div class="page-header">
            <h1>HISTORY</h1>
        </div>

        <div class="filters">
            <div class="filter-group">
                <div class="filter-item">
                    <label>Sort by:</label>
                    <select>
                        <option>Latest</option>
                        <option>Highest score</option>
                        <option>Lowest score</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Time period:</label>
                    <select>
                        <option>All</option>
                        <option>Last 7 days</option>
                        <option>Last 30 days</option>
                        <option>Last 90 days</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Search:</label>
                    <input type="text" placeholder="Enter the job name...">
                </div>
            </div>
        </div>

        <div class="scan-list">
            <!-- Scan Result 1 -->
            <div class="scan-card">
                <div class="score-circle high-score">85%</div>
                <div class="scan-details">
                    <h3>Frontend Developer - ABC Company</h3>
                    <div class="scan-meta">
                        <span>Scan date: 08/01/2025</span>
                        <span>ATS: Workday</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">JavaScript</span>
                        <span class="skill-tag">React</span>
                        <span class="skill-tag">Node.js</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>

            <!-- Scan Result 2 -->
            <div class="scan-card">
                <div class="score-circle medium-score">65%</div>
                <div class="scan-details">
                    <h3>Full Stack Developer - XYZ Corp</h3>
                    <div class="scan-meta">
                        <span>Scan date: 07/01/2025</span>
                        <span>ATS: Greenhouse</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Python</span>
                        <span class="skill-tag">Django</span>
                        <span class="skill-tag">PostgreSQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>

            <!-- Scan Result 3 -->
            <div class="scan-card">
                <div class="score-circle low-score">45%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 4 -->
             <div class="scan-card">
                <div class="score-circle medium-score">65%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 5 -->
             <div class="scan-card">
                <div class="score-circle high-score">95%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 6 -->
             <div class="scan-card">
                <div class="score-circle high-score">98%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 7 -->
             <div class="scan-card">
                <div class="score-circle low-score">35%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 8 -->
             <div class="scan-card">
                <div class="score-circle low-score">45%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 9 -->
             <div class="scan-card">
                <div class="score-circle high-score">87%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
             <!-- Scan Result 10 -->
             <div class="scan-card">
                <div class="score-circle low-score">45%</div>
                <div class="scan-details">
                    <h3>Backend Engineer - DEF Solutions</h3>
                    <div class="scan-meta">
                        <span>Scan date: 06/01/2025</span>
                        <span>ATS: Lever</span>
                    </div>
                    <div class="skills-list">
                        <span class="skill-tag">Java</span>
                        <span class="skill-tag">Spring Boot</span>
                        <span class="skill-tag">MySQL</span>
                    </div>
                </div>
                <div class="actions">
                    <a href="#" class="btn btn-primary">See details</a>
                    <a href="#" class="btn btn-secondary">Download PDF</a>
                </div>
            </div>
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button class="page-btn">Previous</button>
            <button class="page-btn active">1</button>
            <button class="page-btn">2</button>
            <button class="page-btn">3</button>
            <button class="page-btn">Next</button>
        </div>

        <!-- Empty State (hidden by default) -->
        <div class="empty-state" style="display: none;">
            <h3>Chưa có lịch sử quét CV</h3>
            <p>Hãy bắt đầu bằng cách tải lên CV của bạn và một mô tả công việc để phân tích.</p>
            <a href="#" class="btn btn-primary">Quét CV đầu tiên</a>
        </div>
    </div>
    <script>
    // Mock data for demonstration
    const mockScans = [
        {
            id: 1,
            score: 85,
            jobTitle: "Frontend Developer",
            company: "ABC Company",
            date: "2025-01-08",
            ats: "Workday",
            skills: ["JavaScript", "React", "Node.js"]
        },
        {
            id: 2,
            score: 65,
            jobTitle: "Full Stack Developer",
            company: "XYZ Corp",
            date: "2025-01-07",
            ats: "Greenhouse",
            skills: ["Python", "Django", "PostgreSQL"]
        },
        {
            id: 3,
            score: 45,
            jobTitle: "Backend Engineer",
            company: "DEF Solutions",
            date: "2025-01-06",
            ats: "Lever",
            skills: ["Java", "Spring Boot", "MySQL"]
        },
        {
            id: 4,
            score: 92,
            jobTitle: "React Developer",
            company: "Tech Solutions",
            date: "2025-01-05",
            ats: "Workday",
            skills: ["React", "TypeScript", "Redux"]
        },
        {
            id: 5,
            score: 78,
            jobTitle: "Frontend Engineer",
            company: "Innovation Labs",
            date: "2025-01-04",
            ats: "Greenhouse",
            skills: ["Vue.js", "JavaScript", "CSS"]
        }
    ];
    
    let currentPage = 1;
    const itemsPerPage = 5;
    let filteredScans = [...mockScans];
    
    // Initialize after DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize filters and sorting
        const sortSelect = document.querySelector('select');
        const timeSelect = document.querySelector('select:nth-of-type(2)');
        const searchInput = document.querySelector('input[type="text"]');
    
        // Sort change handler
        sortSelect.addEventListener('change', function() {
            sortScans(this.value);
            currentPage = 1;
            updateDisplay();
        });
    
        // Time filter change handler
        timeSelect.addEventListener('change', function() {
            filterByTime(this.value);
            currentPage = 1;
            updateDisplay();
        });
    
        // Search input handler with debounce
        let debounceTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(debounceTimeout);
            debounceTimeout = setTimeout(() => {
                filterBySearch(this.value);
                currentPage = 1;
                updateDisplay();
            }, 300);
        });
    
        // Initialize pagination
        setupPagination();
        updateDisplay();
    
        // New Scan button handler
        document.querySelector('.page-header .btn-primary').addEventListener('click', function() {
            window.location.href = '/new-scan';
        });
    });
    
    function sortScans(criteria) {
        console.log("Sorting by:", criteria); // Thêm log để debug
        switch(criteria) {
            case 'Latest':
                filteredScans = [...mockScans].sort((a, b) => new Date(b.date) - new Date(a.date));
                break;
            case 'Highest score':
                filteredScans = [...mockScans].sort((a, b) => b.score - a.score);
                break;
            case 'Lowest score':
                filteredScans = [...mockScans].sort((a, b) => a.score - b.score);
                break;
            default:
                filteredScans = [...mockScans];
                break;
        }
        console.log("Sorted results:", filteredScans); // Log kết quả sau khi sort
    }
    
    function filterByTime(timeFrame) {
        const now = new Date();
        filteredScans = mockScans.filter(scan => {
            const scanDate = new Date(scan.date);
            switch(timeFrame) {
                case 'Last 7 days':
                    return (now - scanDate) <= 7 * 24 * 60 * 60 * 1000;
                case 'Last 30 days':
                    return (now - scanDate) <= 30 * 24 * 60 * 60 * 1000;
                case 'Last 90 days':
                    return (now - scanDate) <= 90 * 24 * 60 * 60 * 1000;
                default:
                    return true;
            }
        });
    }
    
    function filterBySearch(searchTerm) {
        if (!searchTerm) {
            filteredScans = [...mockScans];
            return;
        }
        searchTerm = searchTerm.toLowerCase();
        filteredScans = mockScans.filter(scan => 
            scan.jobTitle.toLowerCase().includes(searchTerm) ||
            scan.company.toLowerCase().includes(searchTerm) ||
            scan.skills.some(skill => skill.toLowerCase().includes(searchTerm))
        );
    }
    
    function getScoreClass(score) {
        if (score >= 80) return 'high-score';
        if (score >= 60) return 'medium-score';
        return 'low-score';
    }
    
    function createScanCard(scan) {
        return `
            <div class="scan-card" data-id="${scan.id}">
                <div class="score-circle ${getScoreClass(scan.score)}">${scan.score}%</div>
                <div class="scan-details">
                    <h3>${scan.jobTitle} - ${scan.company}</h3>
                    <div class="scan-meta">
                        <span>Quét ngày: ${new Date(scan.date).toLocaleDateString('vi-VN')}</span>
                        <span>ATS: ${scan.ats}</span>
                    </div>
                    <div class="skills-list">
                        ${scan.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                    </div>
                </div>
                <div class="actions">
                    <button class="btn btn-primary" onclick="viewDetails(${scan.id})">Xem chi tiết</button>
                    <button class="btn btn-secondary" onclick="downloadPDF(${scan.id})">Tải PDF</button>
                </div>
            </div>
        `;
    }
    
    function updateDisplay() {
        const scanList = document.querySelector('.scan-list');
        const emptyState = document.querySelector('.empty-state');
        
        if (filteredScans.length === 0) {
            scanList.style.display = 'none';
            emptyState.style.display = 'block';
            return;
        }
    
        scanList.style.display = 'grid';
        emptyState.style.display = 'none';
    
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const currentScans = filteredScans.slice(startIndex, endIndex);
    
        scanList.innerHTML = currentScans.map(scan => createScanCard(scan)).join('');
        updatePagination();
    }
    
    function setupPagination() {
        const pagination = document.querySelector('.pagination');
        pagination.addEventListener('click', function(e) {
            if (e.target.classList.contains('page-btn')) {
                const action = e.target.textContent;
                const totalPages = Math.ceil(filteredScans.length / itemsPerPage);
    
                if (action === 'Previous' && currentPage > 1) {
                    currentPage--;
                } else if (action === 'Next' && currentPage < totalPages) {
                    currentPage++;
                } else if (action !== 'Previous' && action !== 'Next') {
                    currentPage = parseInt(action);
                }
    
                updateDisplay();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
    }
    
    function updatePagination() {
        const totalPages = Math.ceil(filteredScans.length / itemsPerPage);
        const pagination = document.querySelector('.pagination');
        
        let paginationHTML = `
            <button class="page-btn" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
        `;
        
        for (let i = 1; i <= totalPages; i++) {
            paginationHTML += `
                <button class="page-btn ${currentPage === i ? 'active' : ''}">${i}</button>
            `;
        }
        
        paginationHTML += `
            <button class="page-btn" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
        `;
        
        pagination.innerHTML = paginationHTML;
    }
    
    function viewDetails(scanId) {
        const scan = filteredScans.find(s => s.id === scanId);
        alert(`Xem chi tiết kết quả quét CV cho vị trí ${scan.jobTitle} tại ${scan.company}`);
    }
    
    function downloadPDF(scanId) {
        const scan = filteredScans.find(s => s.id === scanId);
        alert(`Tải PDF kết quả quét CV cho vị trí ${scan.jobTitle} tại ${scan.company}`);
    }
</script>
</body>
</html>